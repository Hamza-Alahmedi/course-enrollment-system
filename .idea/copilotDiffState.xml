<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/JWT_BUILD_FIX.md">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/JWT_BUILD_FIX.md" />
              <option name="updatedContent" value="#  JWT Build Fix - Render Deployment&#10;&#10;## Problem&#10;The Docker build on Render was failing with compilation errors:&#10;```&#10;[ERROR] cannot find symbol: method parserBuilder()&#10;[ERROR] cannot find symbol: method parseClaimsJws(java.lang.String)&#10;```&#10;&#10;## Root Cause&#10;The `jjwt-impl` and `jjwt-jackson` dependencies were set to `&lt;scope&gt;runtime&lt;/scope&gt;` in `pom.xml`. This means:&#10;- The implementation classes were NOT available during compilation&#10;- Only the API interfaces (from `jjwt-api`) were visible to the compiler&#10;- The `JwtParserBuilder` and its methods couldn't be found during the Maven build in Docker&#10;&#10;## Solution Applied&#10;&#10;### 1. Fixed `pom.xml` - Removed Runtime Scope ✅&#10;**Changed:**&#10;```xml&#10;&lt;!-- BEFORE - Runtime scope prevented compilation --&gt;&#10;&lt;dependency&gt;&#10;    &lt;groupId&gt;io.jsonwebtoken&lt;/groupId&gt;&#10;    &lt;artifactId&gt;jjwt-impl&lt;/artifactId&gt;&#10;    &lt;version&gt;0.12.3&lt;/version&gt;&#10;    &lt;scope&gt;runtime&lt;/scope&gt;  ❌&#10;&lt;/dependency&gt;&#10;&lt;dependency&gt;&#10;    &lt;groupId&gt;io.jsonwebtoken&lt;/groupId&gt;&#10;    &lt;artifactId&gt;jjwt-jackson&lt;/artifactId&gt;&#10;    &lt;version&gt;0.12.3&lt;/version&gt;&#10;    &lt;scope&gt;runtime&lt;/scope&gt;  ❌&#10;&lt;/dependency&gt;&#10;```&#10;&#10;**To:**&#10;```xml&#10;&lt;!-- AFTER - Compile scope allows build to succeed --&gt;&#10;&lt;dependency&gt;&#10;    &lt;groupId&gt;io.jsonwebtoken&lt;/groupId&gt;&#10;    &lt;artifactId&gt;jjwt-impl&lt;/artifactId&gt;&#10;    &lt;version&gt;0.12.3&lt;/version&gt;&#10;    &lt;!-- No scope = compile scope ✅ --&gt;&#10;&lt;/dependency&gt;&#10;&lt;dependency&gt;&#10;    &lt;groupId&gt;io.jsonwebtoken&lt;/groupId&gt;&#10;    &lt;artifactId&gt;jjwt-jackson&lt;/artifactId&gt;&#10;    &lt;version&gt;0.12.3&lt;/version&gt;&#10;    &lt;!-- No scope = compile scope ✅ --&gt;&#10;&lt;/dependency&gt;&#10;```&#10;&#10;### 2. Kept JwtUtil.java Using Correct API ✅&#10;The code in `JwtUtil.java` is correct and uses the proper JJWT 0.12.3 API:&#10;```java&#10;private Claims extractAllClaims(String token) {&#10;    return Jwts.parserBuilder()  // ✅ Correct for 0.12.3&#10;            .setSigningKey(getSigningKey())&#10;            .build()&#10;            .parseClaimsJws(token)&#10;            .getBody();&#10;}&#10;```&#10;&#10;## Files Modified&#10;1. ✅ `course-enrollment-backend/pom.xml` - Removed runtime scope from jjwt dependencies&#10;2. ✅ `course-enrollment-backend/src/main/java/com/hamza/courseenrollmentsystem/util/JwtUtil.java` - Restored to use parserBuilder()&#10;&#10;## Why This Works&#10;- **Compile Scope (default)**: Dependencies are available during compilation, testing, and runtime&#10;- **Runtime Scope**: Dependencies are only available at runtime, NOT during compilation&#10;- By removing the `&lt;scope&gt;runtime&lt;/scope&gt;`, Maven now includes the full JJWT implementation during the Docker build&#10;- The `parserBuilder()` method and `JwtParserBuilder` class are now visible to the compiler&#10;&#10;## Next Steps&#10;&#10;### 1. Commit and Push Changes&#10;```bash&#10;cd &quot;C:\Users\hamza\OneDrive\Desktop\Online Course Enrolment System&quot;&#10;git add course-enrollment-backend/pom.xml course-enrollment-backend/src/main/java/com/hamza/courseenrollmentsystem/util/JwtUtil.java&#10;git commit -m &quot;fix(jwt): Change jjwt dependencies to compile scope for Docker build&#10;&#10;- Remove runtime scope from jjwt-impl and jjwt-jackson&#10;- This allows parserBuilder() and related APIs to be visible during Maven compilation&#10;- Fixes Docker build failure on Render deployment&#10;&#10;Resolves: 'cannot find symbol: method parserBuilder()' compilation error&quot;&#10;git push origin main&#10;```&#10;&#10;### 2. Verify Render Deployment&#10;1. Push will trigger auto-deploy on Render&#10;2. Watch the build logs in Render Dashboard&#10;3. The `mvn clean package -DskipTests` step should now succeed&#10;4. Backend should deploy successfully&#10;&#10;### 3. Expected Build Output (Success)&#10;```&#10;[INFO] Building jar: /app/target/Course-Enrollment-System-0.0.1-SNAPSHOT.jar&#10;[INFO] BUILD SUCCESS&#10;```&#10;&#10;## Why Runtime Scope Was Wrong&#10;According to Maven documentation:&#10;- **compile** (default): Available in all classpaths (compile, test, runtime) ✅&#10;- **runtime**: NOT available during compilation, only at runtime ❌&#10;&#10;Since `JwtUtil.java` needs to call methods from `jjwt-impl` during compilation, the dependency MUST be compile-scoped.&#10;&#10;## Additional Notes&#10;- This is a common mistake when working with JJWT&#10;- The JJWT documentation recommends compile scope for `jjwt-impl` when using the builder APIs&#10;- Runtime scope is only appropriate when using pure interfaces with no builder patterns&#10;&#10;---&#10;&#10;**Status**: ✅ FIXED&#10;**Date**: December 16, 2025&#10;**Deploy Ready**: YES - Push to trigger Render deployment&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/course-enrollment-backend/pom.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/course-enrollment-backend/pom.xml" />
              <option name="originalContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&#10;&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&#10;         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;&#10;    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;&#10;    &lt;parent&gt;&#10;        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&#10;        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;&#10;        &lt;version&gt;3.5.8&lt;/version&gt;&#10;        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;&#10;    &lt;/parent&gt;&#10;    &lt;groupId&gt;com.hamza&lt;/groupId&gt;&#10;    &lt;artifactId&gt;Course-Enrollment-System&lt;/artifactId&gt;&#10;    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;&#10;    &lt;name&gt;Course Enrollment System&lt;/name&gt;&#10;    &lt;description&gt;Course Enrollment System&lt;/description&gt;&#10;    &lt;url/&gt;&#10;    &lt;licenses&gt;&#10;        &lt;license/&gt;&#10;    &lt;/licenses&gt;&#10;    &lt;developers&gt;&#10;        &lt;developer/&gt;&#10;    &lt;/developers&gt;&#10;    &lt;scm&gt;&#10;        &lt;connection/&gt;&#10;        &lt;developerConnection/&gt;&#10;        &lt;tag/&gt;&#10;        &lt;url/&gt;&#10;    &lt;/scm&gt;&#10;    &lt;properties&gt;&#10;        &lt;java.version&gt;17&lt;/java.version&gt;&#10;    &lt;/properties&gt;&#10;    &lt;dependencies&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&#10;            &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&#10;            &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&#10;            &lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&#10;            &lt;artifactId&gt;spring-boot-starter-validation&lt;/artifactId&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&#10;            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.thymeleaf.extras&lt;/groupId&gt;&#10;            &lt;artifactId&gt;thymeleaf-extras-springsecurity6&lt;/artifactId&gt;&#10;        &lt;/dependency&gt;&#10;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;com.mysql&lt;/groupId&gt;&#10;            &lt;artifactId&gt;mysql-connector-j&lt;/artifactId&gt;&#10;            &lt;scope&gt;runtime&lt;/scope&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;&#10;            &lt;artifactId&gt;lombok&lt;/artifactId&gt;&#10;            &lt;optional&gt;true&lt;/optional&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&#10;            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;&#10;            &lt;scope&gt;test&lt;/scope&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.springframework.security&lt;/groupId&gt;&#10;            &lt;artifactId&gt;spring-security-test&lt;/artifactId&gt;&#10;            &lt;scope&gt;test&lt;/scope&gt;&#10;        &lt;/dependency&gt;&#10;&#10;        &lt;!-- JWT Dependencies --&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;io.jsonwebtoken&lt;/groupId&gt;&#10;            &lt;artifactId&gt;jjwt-api&lt;/artifactId&gt;&#10;            &lt;version&gt;0.12.3&lt;/version&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;io.jsonwebtoken&lt;/groupId&gt;&#10;            &lt;artifactId&gt;jjwt-impl&lt;/artifactId&gt;&#10;            &lt;version&gt;0.12.3&lt;/version&gt;&#10;            &lt;scope&gt;runtime&lt;/scope&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;io.jsonwebtoken&lt;/groupId&gt;&#10;            &lt;artifactId&gt;jjwt-jackson&lt;/artifactId&gt;&#10;            &lt;version&gt;0.12.3&lt;/version&gt;&#10;            &lt;scope&gt;runtime&lt;/scope&gt;&#10;        &lt;/dependency&gt;&#10;    &lt;/dependencies&gt;&#10;&#10;    &lt;build&gt;&#10;        &lt;plugins&gt;&#10;            &lt;plugin&gt;&#10;                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;&#10;                &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;&#10;                &lt;configuration&gt;&#10;                    &lt;annotationProcessorPaths&gt;&#10;                        &lt;path&gt;&#10;                            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;&#10;                            &lt;artifactId&gt;lombok&lt;/artifactId&gt;&#10;                        &lt;/path&gt;&#10;                    &lt;/annotationProcessorPaths&gt;&#10;                &lt;/configuration&gt;&#10;            &lt;/plugin&gt;&#10;            &lt;plugin&gt;&#10;                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&#10;                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;&#10;                &lt;configuration&gt;&#10;                    &lt;excludes&gt;&#10;                        &lt;exclude&gt;&#10;                            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;&#10;                            &lt;artifactId&gt;lombok&lt;/artifactId&gt;&#10;                        &lt;/exclude&gt;&#10;                    &lt;/excludes&gt;&#10;                &lt;/configuration&gt;&#10;            &lt;/plugin&gt;&#10;        &lt;/plugins&gt;&#10;    &lt;/build&gt;&#10;&#10;&lt;/project&gt;&#10;" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&#10;&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&#10;         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;&#10;    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;&#10;    &lt;parent&gt;&#10;        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&#10;        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;&#10;        &lt;version&gt;3.5.8&lt;/version&gt;&#10;        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;&#10;    &lt;/parent&gt;&#10;    &lt;groupId&gt;com.hamza&lt;/groupId&gt;&#10;    &lt;artifactId&gt;Course-Enrollment-System&lt;/artifactId&gt;&#10;    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;&#10;    &lt;name&gt;Course Enrollment System&lt;/name&gt;&#10;    &lt;description&gt;Course Enrollment System&lt;/description&gt;&#10;    &lt;url/&gt;&#10;    &lt;licenses&gt;&#10;        &lt;license/&gt;&#10;    &lt;/licenses&gt;&#10;    &lt;developers&gt;&#10;        &lt;developer/&gt;&#10;    &lt;/developers&gt;&#10;    &lt;scm&gt;&#10;        &lt;connection/&gt;&#10;        &lt;developerConnection/&gt;&#10;        &lt;tag/&gt;&#10;        &lt;url/&gt;&#10;    &lt;/scm&gt;&#10;    &lt;properties&gt;&#10;        &lt;java.version&gt;17&lt;/java.version&gt;&#10;    &lt;/properties&gt;&#10;    &lt;dependencies&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&#10;            &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&#10;            &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&#10;            &lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&#10;            &lt;artifactId&gt;spring-boot-starter-validation&lt;/artifactId&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&#10;            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.thymeleaf.extras&lt;/groupId&gt;&#10;            &lt;artifactId&gt;thymeleaf-extras-springsecurity6&lt;/artifactId&gt;&#10;        &lt;/dependency&gt;&#10;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;com.mysql&lt;/groupId&gt;&#10;            &lt;artifactId&gt;mysql-connector-j&lt;/artifactId&gt;&#10;            &lt;scope&gt;runtime&lt;/scope&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;&#10;            &lt;artifactId&gt;lombok&lt;/artifactId&gt;&#10;            &lt;optional&gt;true&lt;/optional&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&#10;            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;&#10;            &lt;scope&gt;test&lt;/scope&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.springframework.security&lt;/groupId&gt;&#10;            &lt;artifactId&gt;spring-security-test&lt;/artifactId&gt;&#10;            &lt;scope&gt;test&lt;/scope&gt;&#10;        &lt;/dependency&gt;&#10;&#10;        &lt;!-- JWT Dependencies --&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;io.jsonwebtoken&lt;/groupId&gt;&#10;            &lt;artifactId&gt;jjwt-api&lt;/artifactId&gt;&#10;            &lt;version&gt;0.12.3&lt;/version&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;io.jsonwebtoken&lt;/groupId&gt;&#10;            &lt;artifactId&gt;jjwt-impl&lt;/artifactId&gt;&#10;            &lt;version&gt;0.12.3&lt;/version&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;io.jsonwebtoken&lt;/groupId&gt;&#10;            &lt;artifactId&gt;jjwt-jackson&lt;/artifactId&gt;&#10;            &lt;version&gt;0.12.3&lt;/version&gt;&#10;        &lt;/dependency&gt;&#10;    &lt;/dependencies&gt;&#10;&#10;    &lt;build&gt;&#10;        &lt;plugins&gt;&#10;            &lt;plugin&gt;&#10;                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;&#10;                &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;&#10;                &lt;configuration&gt;&#10;                    &lt;annotationProcessorPaths&gt;&#10;                        &lt;path&gt;&#10;                            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;&#10;                            &lt;artifactId&gt;lombok&lt;/artifactId&gt;&#10;                        &lt;/path&gt;&#10;                    &lt;/annotationProcessorPaths&gt;&#10;                &lt;/configuration&gt;&#10;            &lt;/plugin&gt;&#10;            &lt;plugin&gt;&#10;                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&#10;                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;&#10;                &lt;configuration&gt;&#10;                    &lt;excludes&gt;&#10;                        &lt;exclude&gt;&#10;                            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;&#10;                            &lt;artifactId&gt;lombok&lt;/artifactId&gt;&#10;                        &lt;/exclude&gt;&#10;                    &lt;/excludes&gt;&#10;                &lt;/configuration&gt;&#10;            &lt;/plugin&gt;&#10;        &lt;/plugins&gt;&#10;    &lt;/build&gt;&#10;&#10;&lt;/project&gt;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/course-enrollment-backend/src/main/java/com/hamza/courseenrollmentsystem/util/JwtUtil.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/course-enrollment-backend/src/main/java/com/hamza/courseenrollmentsystem/util/JwtUtil.java" />
              <option name="originalContent" value="package com.hamza.courseenrollmentsystem.util;&#10;&#10;import io.jsonwebtoken.Claims;&#10;import io.jsonwebtoken.Jwts;&#10;import io.jsonwebtoken.SignatureAlgorithm;&#10;import io.jsonwebtoken.security.Keys;&#10;import org.springframework.beans.factory.annotation.Value;&#10;import org.springframework.security.core.userdetails.UserDetails;&#10;import org.springframework.stereotype.Component;&#10;&#10;import javax.crypto.SecretKey;&#10;import java.nio.charset.StandardCharsets;&#10;import java.util.Date;&#10;import java.util.HashMap;&#10;import java.util.Map;&#10;import java.util.function.Function;&#10;&#10;@Component&#10;public class JwtUtil {&#10;&#10;    @Value(&quot;${jwt.secret:mySecretKeyForJWTTokenGenerationThatNeedsToBeVeryLongForHS256Algorithm}&quot;)&#10;    private String secret;&#10;&#10;    @Value(&quot;${jwt.expiration:86400000}&quot;) // 24 hours in milliseconds&#10;    private Long expiration;&#10;&#10;    // Generate token with email and role&#10;    public String generateToken(String email, String role, Long userId) {&#10;        Map&lt;String, Object&gt; claims = new HashMap&lt;&gt;();&#10;        claims.put(&quot;role&quot;, role);&#10;        claims.put(&quot;userId&quot;, userId);&#10;        return createToken(claims, email);&#10;    }&#10;&#10;    // Create token&#10;    private String createToken(Map&lt;String, Object&gt; claims, String subject) {&#10;        Date now = new Date();&#10;        Date expiryDate = new Date(now.getTime() + expiration);&#10;&#10;        return Jwts.builder()&#10;                .setClaims(claims)&#10;                .setSubject(subject)&#10;                .setIssuedAt(now)&#10;                .setExpiration(expiryDate)&#10;                .signWith(getSigningKey(), SignatureAlgorithm.HS256)&#10;                .compact();&#10;    }&#10;&#10;    // Get signing key&#10;    private SecretKey getSigningKey() {&#10;        byte[] keyBytes = secret.getBytes(StandardCharsets.UTF_8);&#10;        return Keys.hmacShaKeyFor(keyBytes);&#10;    }&#10;&#10;    // Extract email from token&#10;    public String extractEmail(String token) {&#10;        return extractClaim(token, Claims::getSubject);&#10;    }&#10;&#10;    // Extract role from token&#10;    public String extractRole(String token) {&#10;        return extractClaim(token, claims -&gt; claims.get(&quot;role&quot;, String.class));&#10;    }&#10;&#10;    // Extract userId from token&#10;    public Long extractUserId(String token) {&#10;        return extractClaim(token, claims -&gt; claims.get(&quot;userId&quot;, Long.class));&#10;    }&#10;&#10;    // Extract expiration date&#10;    public Date extractExpiration(String token) {&#10;        return extractClaim(token, Claims::getExpiration);&#10;    }&#10;&#10;    // Extract claim&#10;    public &lt;T&gt; T extractClaim(String token, Function&lt;Claims, T&gt; claimsResolver) {&#10;        final Claims claims = extractAllClaims(token);&#10;        return claimsResolver.apply(claims);&#10;    }&#10;&#10;    // Extract all claims&#10;    private Claims extractAllClaims(String token) {&#10;        // Use the older parser API (parser()) for compatibility with the jjwt version available&#10;        byte[] keyBytes = secret.getBytes(StandardCharsets.UTF_8);&#10;        return Jwts.parser()&#10;                .setSigningKey(keyBytes)&#10;                .parseClaimsJws(token)&#10;                .getBody();&#10;    }&#10;&#10;    // Check if token is expired&#10;    private Boolean isTokenExpired(String token) {&#10;        return extractExpiration(token).before(new Date());&#10;    }&#10;&#10;    // Validate token&#10;    public Boolean validateToken(String token, String email) {&#10;        final String extractedEmail = extractEmail(token);&#10;        return (extractedEmail.equals(email) &amp;&amp; !isTokenExpired(token));&#10;    }&#10;&#10;    // Validate token with UserDetails&#10;    public Boolean validateToken(String token, UserDetails userDetails) {&#10;        final String email = extractEmail(token);&#10;        return (email.equals(userDetails.getUsername()) &amp;&amp; !isTokenExpired(token));&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.hamza.courseenrollmentsystem.util;&#10;&#10;import io.jsonwebtoken.Claims;&#10;import io.jsonwebtoken.Jwts;&#10;import io.jsonwebtoken.SignatureAlgorithm;&#10;import io.jsonwebtoken.security.Keys;&#10;import org.springframework.beans.factory.annotation.Value;&#10;import org.springframework.security.core.userdetails.UserDetails;&#10;import org.springframework.stereotype.Component;&#10;&#10;import javax.crypto.SecretKey;&#10;import java.nio.charset.StandardCharsets;&#10;import java.util.Date;&#10;import java.util.HashMap;&#10;import java.util.Map;&#10;import java.util.function.Function;&#10;&#10;@Component&#10;public class JwtUtil {&#10;&#10;    @Value(&quot;${jwt.secret:mySecretKeyForJWTTokenGenerationThatNeedsToBeVeryLongForHS256Algorithm}&quot;)&#10;    private String secret;&#10;&#10;    @Value(&quot;${jwt.expiration:86400000}&quot;) // 24 hours in milliseconds&#10;    private Long expiration;&#10;&#10;    // Generate token with email and role&#10;    public String generateToken(String email, String role, Long userId) {&#10;        Map&lt;String, Object&gt; claims = new HashMap&lt;&gt;();&#10;        claims.put(&quot;role&quot;, role);&#10;        claims.put(&quot;userId&quot;, userId);&#10;        return createToken(claims, email);&#10;    }&#10;&#10;    // Create token&#10;    private String createToken(Map&lt;String, Object&gt; claims, String subject) {&#10;        Date now = new Date();&#10;        Date expiryDate = new Date(now.getTime() + expiration);&#10;&#10;        return Jwts.builder()&#10;                .setClaims(claims)&#10;                .setSubject(subject)&#10;                .setIssuedAt(now)&#10;                .setExpiration(expiryDate)&#10;                .signWith(getSigningKey(), SignatureAlgorithm.HS256)&#10;                .compact();&#10;    }&#10;&#10;    // Get signing key&#10;    private SecretKey getSigningKey() {&#10;        byte[] keyBytes = secret.getBytes(StandardCharsets.UTF_8);&#10;        return Keys.hmacShaKeyFor(keyBytes);&#10;    }&#10;&#10;    // Extract email from token&#10;    public String extractEmail(String token) {&#10;        return extractClaim(token, Claims::getSubject);&#10;    }&#10;&#10;    // Extract role from token&#10;    public String extractRole(String token) {&#10;        return extractClaim(token, claims -&gt; claims.get(&quot;role&quot;, String.class));&#10;    }&#10;&#10;    // Extract userId from token&#10;    public Long extractUserId(String token) {&#10;        return extractClaim(token, claims -&gt; claims.get(&quot;userId&quot;, Long.class));&#10;    }&#10;&#10;    // Extract expiration date&#10;    public Date extractExpiration(String token) {&#10;        return extractClaim(token, Claims::getExpiration);&#10;    }&#10;&#10;    // Extract claim&#10;    public &lt;T&gt; T extractClaim(String token, Function&lt;Claims, T&gt; claimsResolver) {&#10;        final Claims claims = extractAllClaims(token);&#10;        return claimsResolver.apply(claims);&#10;    }&#10;&#10;    // Extract all claims&#10;    private Claims extractAllClaims(String token) {&#10;        return Jwts.parserBuilder()&#10;                .setSigningKey(getSigningKey())&#10;                .build()&#10;                .parseClaimsJws(token)&#10;                .getBody();&#10;    }&#10;&#10;    // Check if token is expired&#10;    private Boolean isTokenExpired(String token) {&#10;        return extractExpiration(token).before(new Date());&#10;    }&#10;&#10;    // Validate token&#10;    public Boolean validateToken(String token, String email) {&#10;        final String extractedEmail = extractEmail(token);&#10;        return (extractedEmail.equals(email) &amp;&amp; !isTokenExpired(token));&#10;    }&#10;&#10;    // Validate token with UserDetails&#10;    public Boolean validateToken(String token, UserDetails userDetails) {&#10;        final String email = extractEmail(token);&#10;        return (email.equals(userDetails.getUsername()) &amp;&amp; !isTokenExpired(token));&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>