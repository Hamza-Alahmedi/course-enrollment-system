<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/BACKEND_ENVIRONMENT_VARIABLES.md">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/BACKEND_ENVIRONMENT_VARIABLES.md" />
              <option name="updatedContent" value="#  Backend Environment Variables - Complete Configuration&#10;&#10;## ✅ Updated Files:&#10;1. `CustomAuthenticationSuccessHandler.java` - Now uses `${frontend.url}` environment variable&#10;2. `application.properties` - Added `frontend.url` configuration&#10;&#10;---&#10;&#10;##  Backend Environment Variables for Render&#10;&#10;Go to **Render Dashboard → Your Backend Service → Environment**&#10;&#10;Add/Update these variables:&#10;&#10;```env&#10;# ============================================&#10;# DATABASE CONFIGURATION (Railway)&#10;# ============================================&#10;&#10;# Database Connection URL&#10;DATABASE_URL=jdbc:mysql://[RAILWAY_HOST]:[RAILWAY_PORT]/[RAILWAY_DATABASE]&#10;&#10;# Database Username (from Railway)&#10;DB_USERNAME=[RAILWAY_USER]&#10;&#10;# Database Password (from Railway)&#10;DB_PASSWORD=[RAILWAY_PASSWORD]&#10;&#10;&#10;# ============================================&#10;# SERVER CONFIGURATION&#10;# ============================================&#10;&#10;# Port (Render sets this automatically)&#10;PORT=8080&#10;&#10;&#10;# ============================================&#10;# FRONTEND CONFIGURATION (Important!)&#10;# ============================================&#10;&#10;# Frontend URL - Used for login redirects&#10;FRONTEND_URL=https://[YOUR-FRONTEND-URL].onrender.com&#10;&#10;&#10;# ============================================&#10;# CORS CONFIGURATION&#10;# ============================================&#10;&#10;# Allowed Origins - Must include frontend URL&#10;ALLOWED_ORIGINS=https://[YOUR-FRONTEND-URL].onrender.com,http://localhost:5173&#10;```&#10;&#10;---&#10;&#10;##  Step-by-Step: Add Environment Variables&#10;&#10;### 1️⃣ Get Your Frontend URL&#10;&#10;1. Go to **Render Dashboard**&#10;2. Click your **Frontend Static Site**&#10;3. Copy the URL (e.g., `https://course-enrollment-frontend-abc123.onrender.com`)&#10;&#10;---&#10;&#10;### 2️⃣ Get Your Railway MySQL Credentials&#10;&#10;1. Go to **Railway Dashboard** (https://railway.app/dashboard)&#10;2. Click your **MySQL service**&#10;3. Click **&quot;Variables&quot;** tab&#10;4. Copy these values:&#10;   - `MYSQLHOST`&#10;   - `MYSQLPORT`&#10;   - `MYSQLDATABASE`&#10;   - `MYSQLUSER`&#10;   - `MYSQLPASSWORD`&#10;&#10;---&#10;&#10;### 3️⃣ Add Variables to Render Backend&#10;&#10;1. Go to **Render Dashboard**&#10;2. Click your **Backend Service** (Docker service)&#10;3. Click **&quot;Environment&quot;** (left sidebar)&#10;4. Click **&quot;Add Environment Variable&quot;**&#10;5. Add each variable one by one:&#10;&#10;---&#10;&#10;#### Variable 1: DATABASE_URL&#10;```&#10;Key:   DATABASE_URL&#10;Value: jdbc:mysql://[MYSQLHOST]:[MYSQLPORT]/[MYSQLDATABASE]&#10;```&#10;&#10;**Example:**&#10;```&#10;jdbc:mysql://containers-us-west-123.railway.app:6543/railway&#10;```&#10;&#10;---&#10;&#10;#### Variable 2: DB_USERNAME&#10;```&#10;Key:   DB_USERNAME&#10;Value: [Your Railway MYSQLUSER]&#10;```&#10;&#10;**Example:**&#10;```&#10;root&#10;```&#10;&#10;---&#10;&#10;#### Variable 3: DB_PASSWORD&#10;```&#10;Key:   DB_PASSWORD&#10;Value: [Your Railway MYSQLPASSWORD]&#10;```&#10;&#10;**Example:**&#10;```&#10;AbCdEfGhIjKlMnOpQrStUvWxYz123456&#10;```&#10;&#10;---&#10;&#10;#### Variable 4: PORT&#10;```&#10;Key:   PORT&#10;Value: 8080&#10;```&#10;&#10;---&#10;&#10;#### Variable 5: FRONTEND_URL ⭐ **NEW - This fixes the redirect!**&#10;```&#10;Key:   FRONTEND_URL&#10;Value: https://[YOUR-FRONTEND-URL].onrender.com&#10;```&#10;&#10;**Example:**&#10;```&#10;https://course-enrollment-frontend-abc123.onrender.com&#10;```&#10;&#10;⚠️ **Important:** &#10;- Use `https://` (not `http://`)&#10;- No trailing slash at the end&#10;- Must be your exact Render frontend URL&#10;&#10;---&#10;&#10;#### Variable 6: ALLOWED_ORIGINS&#10;```&#10;Key:   ALLOWED_ORIGINS&#10;Value: https://[YOUR-FRONTEND-URL].onrender.com,http://localhost:5173&#10;```&#10;&#10;**Example:**&#10;```&#10;https://course-enrollment-frontend-abc123.onrender.com,http://localhost:5173&#10;```&#10;&#10;---&#10;&#10;### 4️⃣ Save and Redeploy&#10;&#10;1. Click **&quot;Save Changes&quot;** in Render&#10;2. Backend will automatically redeploy (~5 minutes)&#10;3. Wait for deployment to complete&#10;4. ✅ **Done!**&#10;&#10;---&#10;&#10;##  Complete Example Configuration&#10;&#10;Here's a complete example with dummy values:&#10;&#10;```env&#10;DATABASE_URL=jdbc:mysql://containers-us-west-123.railway.app:6543/railway&#10;DB_USERNAME=root&#10;DB_PASSWORD=AbCdEfGhIjKlMnOpQrStUvWxYz123456&#10;PORT=8080&#10;FRONTEND_URL=https://course-enrollment-frontend-abc123.onrender.com&#10;ALLOWED_ORIGINS=https://course-enrollment-frontend-abc123.onrender.com,http://localhost:5173&#10;```&#10;&#10;---&#10;&#10;##  What This Fixes&#10;&#10;### Before (The Problem):&#10;```java&#10;// Hardcoded localhost&#10;response.sendRedirect(&quot;http://localhost:5173?studentId=&quot; + student.getId());&#10;```&#10;&#10;**Result:** When you login from backend, it redirects to `localhost:5173` (doesn't work on Render)&#10;&#10;### After (The Solution):&#10;```java&#10;// Uses environment variable&#10;response.sendRedirect(frontendUrl + &quot;?studentId=&quot; + student.getId());&#10;```&#10;&#10;**Result:** When you login from backend, it redirects to your live frontend URL on Render! ✅&#10;&#10;---&#10;&#10;## ✅ Testing After Update&#10;&#10;### Test 1: Login from Backend HTML Page&#10;1. Go to your backend URL: `https://your-backend.onrender.com/login`&#10;2. Login with student credentials&#10;3. Should redirect to: `https://your-frontend.onrender.com?studentId=1`&#10;4. ✅ Student dashboard loads with data!&#10;&#10;### Test 2: Login from Frontend React Page&#10;1. Go to your frontend URL: `https://your-frontend.onrender.com`&#10;2. Login with student credentials&#10;3. Should stay on frontend and show dashboard&#10;4. ✅ Works as expected!&#10;&#10;---&#10;&#10;##  Troubleshooting&#10;&#10;### Problem: Still redirects to localhost&#10;&#10;**Solution:**&#10;1. Verify `FRONTEND_URL` variable is set in Render&#10;2. Check it has correct frontend URL&#10;3. Ensure backend redeployed after adding variable&#10;4. Check backend logs for the frontend URL being used&#10;&#10;### Problem: Redirect goes to wrong URL&#10;&#10;**Solution:**&#10;1. Check `FRONTEND_URL` value has no typos&#10;2. Ensure it uses `https://` (not `http://`)&#10;3. Remove any trailing slashes&#10;4. Must match your exact frontend URL&#10;&#10;### Problem: CORS error after redirect&#10;&#10;**Solution:**&#10;1. Check `ALLOWED_ORIGINS` includes your frontend URL&#10;2. Format: `https://your-frontend.onrender.com,http://localhost:5173`&#10;3. Save changes and wait for redeploy&#10;&#10;---&#10;&#10;##  Environment Variables Summary&#10;&#10;| Variable | Purpose | Example Value |&#10;|----------|---------|---------------|&#10;| `DATABASE_URL` | MySQL connection | `jdbc:mysql://host:port/db` |&#10;| `DB_USERNAME` | Database user | `root` |&#10;| `DB_PASSWORD` | Database password | `secret123` |&#10;| `PORT` | Server port | `8080` |&#10;| `FRONTEND_URL` ⭐ | **Login redirect URL** | `https://frontend.onrender.com` |&#10;| `ALLOWED_ORIGINS` | CORS origins | `https://frontend.onrender.com,...` |&#10;&#10;---&#10;&#10;##  Quick Checklist&#10;&#10;- [ ] Frontend deployed and URL copied&#10;- [ ] Railway MySQL credentials copied&#10;- [ ] Added `DATABASE_URL` to backend&#10;- [ ] Added `DB_USERNAME` to backend&#10;- [ ] Added `DB_PASSWORD` to backend&#10;- [ ] Added `PORT=8080` to backend&#10;- [ ] Added `FRONTEND_URL` with frontend URL ⭐&#10;- [ ] Added `ALLOWED_ORIGINS` with frontend URL&#10;- [ ] Saved changes in Render&#10;- [ ] Backend redeployed successfully&#10;- [ ] Tested login from backend HTML&#10;- [ ] Tested login from frontend React&#10;- [ ] ✅ Both work correctly!&#10;&#10;---&#10;&#10;##  Next Steps&#10;&#10;1. **Commit the code changes:**&#10;   ```powershell&#10;   cd &quot;C:\Users\hamza\OneDrive\Desktop\Online Course Enrolment System&quot;&#10;   git add .&#10;   git commit -m &quot;Fix: Use environment variable for frontend URL in login redirect&quot;&#10;   git push origin main&#10;   ```&#10;&#10;2. **Add environment variables in Render** (as shown above)&#10;&#10;3. **Wait for backend to redeploy** (~5 minutes)&#10;&#10;4. **Test login from backend** - Should redirect to frontend URL! ✅&#10;&#10;---&#10;&#10;**The key fix is adding `FRONTEND_URL` environment variable!** &#10;&#10;**Status:** ✅ Code updated, ready for deployment&#10;**Action Required:** Add environment variables in Render&#10;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/RENDER_FRONTEND_FIX.md">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/RENDER_FRONTEND_FIX.md" />
              <option name="updatedContent" value="#  EXACT Render Configuration for Your Frontend&#10;&#10;## ✅ Your Actual Folder Structure:&#10;```&#10;Online Course Enrolment System/&#10;└── student-frontend/          ← Your frontend is HERE&#10;    ├── package.json&#10;    ├── vite.config.js&#10;    ├── src/&#10;    └── dist/ (created after build)&#10;```&#10;&#10;---&#10;&#10;##  EXACT Render Settings (Copy These Values)&#10;&#10;Go to: **Render Dashboard → Your Frontend Service → Settings**&#10;&#10;### 1. Root Directory:&#10;```&#10;student-frontend&#10;```&#10;&#10;### 2. Build Command:&#10;```&#10;npm install &amp;&amp; npm run build&#10;```&#10;&#10;### 3. Publish Directory:&#10;```&#10;dist&#10;```&#10;&#10;**That's it!** These 3 settings are all you need.&#10;&#10;---&#10;&#10;##  Visual Guide - Where to Enter These:&#10;&#10;```&#10;Render Dashboard&#10;  → Click your Frontend Service&#10;    → Click &quot;Settings&quot; (left sidebar)&#10;      → Scroll to &quot;Build &amp; Deploy&quot; section&#10;        &#10;        ┌─────────────────────────────────────┐&#10;        │ Root Directory                      │&#10;        │ student-frontend                    │ ← Type this&#10;        └─────────────────────────────────────┘&#10;        &#10;        ┌─────────────────────────────────────┐&#10;        │ Build Command                       │&#10;        │ npm install &amp;&amp; npm run build        │ ← Type this&#10;        └─────────────────────────────────────┘&#10;        &#10;        ┌─────────────────────────────────────┐&#10;        │ Publish Directory                   │&#10;        │ dist                                │ ← Type this&#10;        └─────────────────────────────────────┘&#10;        &#10;        [Save Changes] ← Click this&#10;```&#10;&#10;---&#10;&#10;## ⚠️ Common Mistake:&#10;&#10;**WRONG:**&#10;```&#10;Root Directory: course-enrollment-frontend  ❌&#10;Root Directory: /student-frontend           ❌&#10;Root Directory: ./student-frontend          ❌&#10;```&#10;&#10;**CORRECT:**&#10;```&#10;Root Directory: student-frontend            ✅&#10;```&#10;&#10;---&#10;&#10;##  After Clicking &quot;Save Changes&quot;:&#10;&#10;1. Render will **automatically redeploy**&#10;2. Watch the logs - you should see:&#10;   ```&#10;   ==&gt; Cloning from GitHub...&#10;   ==&gt; Entering directory student-frontend&#10;   ==&gt; Running 'npm install'&#10;   ==&gt; Running 'npm run build'&#10;   ==&gt; Build successful!&#10;   ==&gt; Deploying...&#10;   ```&#10;3. Your frontend will be live! &#10;&#10;---&#10;&#10;##  If You Still Get &quot;vite: not found&quot;:&#10;&#10;**Double-check these:**&#10;&#10;1. **Root Directory** = `student-frontend` (exactly, no slashes)&#10;2. **Build Command** = `npm install &amp;&amp; npm run build`&#10;3. **You clicked &quot;Save Changes&quot;**&#10;4. **Render redeployed** (check logs for new deployment)&#10;&#10;---&#10;&#10;## ✅ Your package.json is Perfect!&#10;&#10;Your `package.json` already has everything needed:&#10;```json&#10;{&#10;  &quot;scripts&quot;: {&#10;    &quot;build&quot;: &quot;vite build&quot;,  ✅&#10;    &quot;start&quot;: &quot;vite preview --port $PORT --host 0.0.0.0&quot;  ✅&#10;  },&#10;  &quot;devDependencies&quot;: {&#10;    &quot;vite&quot;: &quot;^7.2.4&quot;  ✅&#10;  }&#10;}&#10;```&#10;&#10;No code changes needed - just fix the Render settings!&#10;&#10;---&#10;&#10;**Update the Root Directory to `student-frontend` and save!**&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/VITE_NOT_FOUND_COMPLETE_FIX.md">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/VITE_NOT_FOUND_COMPLETE_FIX.md" />
              <option name="updatedContent" value="#  VITE NOT FOUND - COMPLETE TROUBLESHOOTING&#10;&#10;## ✅ What I Just Fixed:&#10;Moved `vite` from `devDependencies` to `dependencies` in your `package.json`.&#10;&#10;**Why?** Some deployment platforms skip `devDependencies` in production, causing Vite to not be installed.&#10;&#10;---&#10;&#10;##  NOW DO THIS (Step by Step):&#10;&#10;### Step 1: Commit and Push the Fixed package.json&#10;&#10;```powershell&#10;cd &quot;C:\Users\hamza\OneDrive\Desktop\Online Course Enrolment System&quot;&#10;git add student-frontend/package.json&#10;git commit -m &quot;Move vite to dependencies for Render deployment&quot;&#10;git push origin main&#10;```&#10;&#10;---&#10;&#10;### Step 2: Check Your Render Service Type&#10;&#10;**CRITICAL:** Are you using a **Web Service** or **Static Site**?&#10;&#10;#### ✅ If You Created a STATIC SITE:&#10;&#10;Go to Render Dashboard → Your Frontend → Settings:&#10;&#10;```&#10;Root Directory:      student-frontend&#10;Build Command:       npm install &amp;&amp; npm run build&#10;Publish Directory:   dist&#10;```&#10;&#10;**No Start Command needed** - Static Sites don't use it!&#10;&#10;#### ❌ If You Created a WEB SERVICE (This is Wrong!):&#10;&#10;**You need to DELETE it and create a STATIC SITE instead!**&#10;&#10;**Why?** Frontend doesn't need a web server - it's just HTML/CSS/JS files.&#10;&#10;---&#10;&#10;### Step 3: Verify Render Configuration&#10;&#10;#### Option A: You Have a STATIC SITE (Correct)&#10;&#10;1. Go to **Render Dashboard**&#10;2. Click your frontend service&#10;3. Look at the top - it should say **&quot;Static Site&quot;** (not &quot;Web Service&quot;)&#10;4. Go to **Settings**&#10;5. Verify:&#10;   ```&#10;   Root Directory:      student-frontend&#10;   Build Command:       npm install &amp;&amp; npm run build&#10;   Publish Directory:   dist&#10;   ```&#10;6. Click **&quot;Save Changes&quot;**&#10;&#10;#### Option B: You Have a WEB SERVICE (Wrong - Fix This)&#10;&#10;**You created the wrong service type!** Here's how to fix:&#10;&#10;1. **Delete the Web Service:**&#10;   - Go to your frontend Web Service&#10;   - Settings → scroll to bottom&#10;   - Click &quot;Delete Web Service&quot;&#10;&#10;2. **Create a Static Site:**&#10;   - Dashboard → &quot;New +&quot; → **&quot;Static Site&quot;** (NOT Web Service!)&#10;   - Connect your repository&#10;   - Configure:&#10;     ```&#10;     Name: course-enrollment-frontend&#10;     Branch: main&#10;     Root Directory: student-frontend&#10;     Build Command: npm install &amp;&amp; npm run build&#10;     Publish Directory: dist&#10;     ```&#10;   - Add Environment Variable:&#10;     ```&#10;     VITE_API_BASE_URL=https://your-backend.onrender.com&#10;     ```&#10;   - Click &quot;Create Static Site&quot;&#10;&#10;---&#10;&#10;##  How to Tell What You Have&#10;&#10;### Check 1: Service Type&#10;&#10;In Render Dashboard, look at your frontend service:&#10;&#10;**Static Site:**&#10;```&#10;┌─────────────────────────────────────┐&#10;│  course-enrollment-frontend       │&#10;│ Static Site                         │ ← Should say this!&#10;└─────────────────────────────────────┘&#10;```&#10;&#10;**Web Service (WRONG):**&#10;```&#10;┌─────────────────────────────────────┐&#10;│ ️ course-enrollment-frontend       │&#10;│ Web Service                         │ ← Wrong type!&#10;└─────────────────────────────────────┘&#10;```&#10;&#10;### Check 2: Settings Available&#10;&#10;**Static Site has:**&#10;- ✅ Root Directory&#10;- ✅ Build Command&#10;- ✅ Publish Directory&#10;- ❌ NO &quot;Start Command&quot; field&#10;&#10;**Web Service has:**&#10;- ✅ Root Directory&#10;- ✅ Build Command&#10;- ✅ Start Command ← If you see this, it's a Web Service!&#10;- ❌ NO &quot;Publish Directory&quot;&#10;&#10;---&#10;&#10;##  The Most Common Issue:&#10;&#10;**You probably created a WEB SERVICE instead of a STATIC SITE!**&#10;&#10;For React frontends on Render:&#10;- ❌ **Wrong:** Web Service&#10;- ✅ **Correct:** Static Site&#10;&#10;### Why This Matters:&#10;&#10;**Web Service:**&#10;- Expects a server to run (needs start command)&#10;- Tries to run `npm start`&#10;- Charges for compute time&#10;- More complex&#10;&#10;**Static Site:**&#10;- Just builds and serves files&#10;- No start command needed&#10;- Free bandwidth&#10;- Simple and correct!&#10;&#10;---&#10;&#10;##  Complete Fix (If You Have Web Service):&#10;&#10;### 1. Delete Current Service&#10;```&#10;Render Dashboard&#10;  → Click your frontend service&#10;  → Settings&#10;  → Scroll to bottom&#10;  → &quot;Delete Web Service&quot;&#10;  → Confirm deletion&#10;```&#10;&#10;### 2. Create New Static Site&#10;```&#10;Render Dashboard&#10;  → New + → Static Site (NOT Web Service!)&#10;  → Connect GitHub repository&#10;  → Configure:&#10;     Name: course-enrollment-frontend&#10;     Branch: main&#10;     Root Directory: student-frontend&#10;     Build Command: npm install &amp;&amp; npm run build&#10;     Publish Directory: dist&#10;  → Environment:&#10;     VITE_API_BASE_URL = https://your-backend.onrender.com&#10;  → Create Static Site&#10;```&#10;&#10;### 3. Wait for Build&#10;- Takes 2-3 minutes&#10;- Check logs for success&#10;- Get your frontend URL&#10;&#10;---&#10;&#10;## ✅ After These Fixes:&#10;&#10;### What Should Happen:&#10;&#10;```bash&#10;==&gt; Cloning repository...&#10;==&gt; Entering directory student-frontend&#10;==&gt; Running 'npm install'&#10;    Added 250 packages&#10;    ✓ Installed vite@7.2.4          ← Should see this!&#10;==&gt; Running 'npm run build'&#10;    vite v7.2.4 building...&#10;    ✓ built in 3s&#10;==&gt; Deploying...&#10;✓ Deploy successful!&#10;```&#10;&#10;---&#10;&#10;##  Still Getting &quot;vite not found&quot;?&#10;&#10;### Try This Build Command Instead:&#10;&#10;```bash&#10;npm ci &amp;&amp; npm run build&#10;```&#10;&#10;**Why?** `npm ci` is stricter and ensures clean install.&#10;&#10;---&#10;&#10;##  Final Checklist&#10;&#10;- [ ] Committed and pushed updated package.json&#10;- [ ] Verified service type (should be **Static Site**)&#10;- [ ] Set Root Directory: `student-frontend`&#10;- [ ] Set Build Command: `npm install &amp;&amp; npm run build`&#10;- [ ] Set Publish Directory: `dist`&#10;- [ ] No &quot;Start Command&quot; field (Static Sites don't have this)&#10;- [ ] Added `VITE_API_BASE_URL` environment variable&#10;- [ ] Saved changes and redeployed&#10;&#10;---&#10;&#10;##  What to Do Right Now:&#10;&#10;1. **Commit the package.json change** (commands above)&#10;2. **Check if you have Static Site or Web Service**&#10;3. **If Web Service: Delete it and create Static Site**&#10;4. **If Static Site: Verify Root Directory is `student-frontend`**&#10;5. **Trigger manual deploy** (Manual Deploy → Deploy)&#10;&#10;---&#10;&#10;##  Most Likely Solution:&#10;&#10;**You need to create a STATIC SITE, not a Web Service!**&#10;&#10;That's why you're getting &quot;start command not found&quot; errors. Static Sites don't use start commands!&#10;&#10;---&#10;&#10;**After you commit the package.json change, verify your service type and reconfigure!** &#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/course-enrollment-backend/src/main/java/com/hamza/courseenrollmentsystem/config/CustomAuthenticationSuccessHandler.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/course-enrollment-backend/src/main/java/com/hamza/courseenrollmentsystem/config/CustomAuthenticationSuccessHandler.java" />
              <option name="originalContent" value="package com.hamza.courseenrollmentsystem.config;&#10;&#10;import com.hamza.courseenrollmentsystem.entity.User;&#10;import com.hamza.courseenrollmentsystem.repository.UserRepository;&#10;import jakarta.servlet.ServletException;&#10;import jakarta.servlet.http.HttpServletRequest;&#10;import jakarta.servlet.http.HttpServletResponse;&#10;import org.springframework.beans.factory.annotation.Autowired;&#10;import org.springframework.security.core.Authentication;&#10;import org.springframework.security.core.authority.SimpleGrantedAuthority;&#10;import org.springframework.security.web.authentication.AuthenticationSuccessHandler;&#10;import org.springframework.stereotype.Component;&#10;&#10;import java.io.IOException;&#10;&#10;@Component&#10;public class CustomAuthenticationSuccessHandler implements AuthenticationSuccessHandler {&#10;&#10;    @Autowired&#10;    private UserRepository userRepository;&#10;&#10;    @Override&#10;    public void onAuthenticationSuccess(HttpServletRequest request,&#10;                                        HttpServletResponse response,&#10;                                        Authentication authentication) throws IOException, ServletException {&#10;&#10;        // Check if user has ADMIN role&#10;        if (authentication.getAuthorities().contains(new SimpleGrantedAuthority(&quot;ROLE_ADMIN&quot;))) {&#10;            // Redirect to admin dashboard&#10;            response.sendRedirect(&quot;/admin/home&quot;);&#10;        } else if (authentication.getAuthorities().contains(new SimpleGrantedAuthority(&quot;ROLE_STUDENT&quot;))) {&#10;            // Get student ID and redirect to React dashboard with ID in URL&#10;            String email = authentication.getName();&#10;            User student = userRepository.findByEmail(email).orElse(null);&#10;            if (student != null) {&#10;                // Redirect to React frontend with student ID as query parameter&#10;                response.sendRedirect(&quot;http://localhost:5173?studentId=&quot; + student.getId());&#10;            } else {&#10;                response.sendRedirect(&quot;/student/dashboard&quot;);&#10;            }&#10;        } else {&#10;            // Default redirect&#10;            response.sendRedirect(&quot;/&quot;);&#10;        }&#10;    }&#10;}&#10;&#10;" />
              <option name="updatedContent" value="package com.hamza.courseenrollmentsystem.config;&#10;&#10;import com.hamza.courseenrollmentsystem.entity.User;&#10;import com.hamza.courseenrollmentsystem.repository.UserRepository;&#10;import jakarta.servlet.ServletException;&#10;import jakarta.servlet.http.HttpServletRequest;&#10;import jakarta.servlet.http.HttpServletResponse;&#10;import org.springframework.beans.factory.annotation.Autowired;&#10;import org.springframework.beans.factory.annotation.Value;&#10;import org.springframework.security.core.Authentication;&#10;import org.springframework.security.core.authority.SimpleGrantedAuthority;&#10;import org.springframework.security.web.authentication.AuthenticationSuccessHandler;&#10;import org.springframework.stereotype.Component;&#10;&#10;import java.io.IOException;&#10;&#10;@Component&#10;public class CustomAuthenticationSuccessHandler implements AuthenticationSuccessHandler {&#10;&#10;    @Autowired&#10;    private UserRepository userRepository;&#10;&#10;    @Value(&quot;${frontend.url:http://localhost:5173}&quot;)&#10;    private String frontendUrl;&#10;&#10;    @Override&#10;    public void onAuthenticationSuccess(HttpServletRequest request,&#10;                                        HttpServletResponse response,&#10;                                        Authentication authentication) throws IOException, ServletException {&#10;&#10;        // Check if user has ADMIN role&#10;        if (authentication.getAuthorities().contains(new SimpleGrantedAuthority(&quot;ROLE_ADMIN&quot;))) {&#10;            // Redirect to admin dashboard&#10;            response.sendRedirect(&quot;/admin/home&quot;);&#10;        } else if (authentication.getAuthorities().contains(new SimpleGrantedAuthority(&quot;ROLE_STUDENT&quot;))) {&#10;            // Get student ID and redirect to React dashboard with ID in URL&#10;            String email = authentication.getName();&#10;            User student = userRepository.findByEmail(email).orElse(null);&#10;            if (student != null) {&#10;                // Redirect to React frontend with student ID as query parameter&#10;                response.sendRedirect(frontendUrl + &quot;?studentId=&quot; + student.getId());&#10;            } else {&#10;                response.sendRedirect(&quot;/student/dashboard&quot;);&#10;            }&#10;        } else {&#10;            // Default redirect&#10;            response.sendRedirect(&quot;/&quot;);&#10;        }&#10;    }&#10;}&#13;&#10;&#13;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/course-enrollment-backend/src/main/resources/application.properties">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/course-enrollment-backend/src/main/resources/application.properties" />
              <option name="originalContent" value="# Database Configuration - Uses environment variables or defaults to local&#10;spring.datasource.url=${DATABASE_URL:jdbc:mysql://localhost:3306/online_course_db}&#10;spring.datasource.username=${DB_USERNAME:course_user}&#10;spring.datasource.password=${DB_PASSWORD:Test123!#}&#10;spring.jpa.hibernate.ddl-auto=update&#10;spring.jpa.show-sql=true&#10;spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQL8Dialect&#10;&#10;# Server Configuration&#10;server.port=${PORT:8080}&#10;&#10;# Thymeleaf Configuration&#10;spring.thymeleaf.prefix=classpath:/templates/&#10;spring.thymeleaf.suffix=.html&#10;spring.thymeleaf.cache=false&#10;spring.thymeleaf.enabled=true&#10;&#10;spring.security.user.name=user&#10;spring.security.user.password=123&#10;&#10;# CORS Configuration - Allow frontend from Render&#10;allowed.origins=${ALLOWED_ORIGINS:http://localhost:5173,http://localhost:3000}&#10;&#10;" />
              <option name="updatedContent" value="# Database Configuration - Uses environment variables or defaults to local&#10;spring.datasource.url=${DATABASE_URL:jdbc:mysql://localhost:3306/online_course_db}&#10;spring.datasource.username=${DB_USERNAME:course_user}&#10;spring.datasource.password=${DB_PASSWORD:Test123!#}&#10;spring.jpa.hibernate.ddl-auto=update&#10;spring.jpa.show-sql=true&#10;spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQL8Dialect&#10;&#10;# Server Configuration&#10;server.port=${PORT:8080}&#10;&#10;# Thymeleaf Configuration&#10;spring.thymeleaf.prefix=classpath:/templates/&#10;spring.thymeleaf.suffix=.html&#10;spring.thymeleaf.cache=false&#10;spring.thymeleaf.enabled=true&#10;&#10;spring.security.user.name=user&#10;spring.security.user.password=123&#10;&#10;# CORS Configuration - Allow frontend from Render&#10;allowed.origins=${ALLOWED_ORIGINS:http://localhost:5173,http://localhost:3000}&#10;&#10;# Frontend URL - For redirects after login&#10;frontend.url=${FRONTEND_URL:http://localhost:5173}&#10;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>